<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Signature Report Builder (Preview & Download PDF)</title>
  <!-- jsPDF & html2canvas CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <link rel="stylesheet" href="sign_standard.css">
</head>
<body>
  <div class="app">
    <!-- LEFT PANEL: FORM CONTROLS -->
    <div class="panel">
      <h2>Report Builder</h2>

      <!-- Client info -->
      <div class="form-section">
        <label for="clientName">Client Name</label>
        <input id="clientName" type="text" value="Meera Khan" />

        <label for="reportDate">Date</label>
        <input id="reportDate" type="text" value="August 8, 2025" />

        <label for="reportId">Report ID</label>
        <input id="reportId" type="text" value="EXP-2025-001" />
      </div>

      <!-- Section 1 Current signature Image Upload -->
      <div class="form-section">
        <h3 class="small">Section 1 - Mistakes in Signature</h3>
        <label>Upload Current Signature</label>
        <input id="uploadMain" type="file" accept="image/*" />
        <div id="mainPreview" class="muted" style="margin-top:8px">No image</div>

        <!---Mistakes in signature -->
        <label style="margin-top:10px">Mistakes in Signature (choose multiple)</label>

        <div id="sign_mistakes_list">
          <!-- First Title + Description input box -->
          <div class="sign_mistake_item">
            <input type="text" placeholder="Enter Title of sign mistake" class="sign_mistake_title"/>
            <textarea placeholder="Enter description of sign mistake pointer" class="sign_mistake_desc"></textarea>
            <button type="button" onclick="removeMistakeItem(this)"> Remove</button>
          </div>
        </div>
        <button type="button" onclick="addMistakeItem()">Add More</button>
        <hr style="margin:14px 0" />
      </div>

      <!-- Section 2 -->
      <div class="form-section">
        <h3 class="small">Section 2 - Personality</h3>
        <label>Strengths</label>
        <div id="strengths_list">
          <div class="strength_item">
            <input type="text" placeholder="Enter a strength" class="strength_title"/>
            <button type="button" onclick="removeStrengthItem(this)">Remove</button>
          </div>
        </div>
        <button type="button" onclick="addStrengthItem()">Add More</button>

        <label style="margin-top:8px">Weaknesses</label>
        <div id="weaknesses_list">
          <div class="weakness_item">
            <input type="text" placeholder="Enter a weakness" class="weakness_title"/>
            <button type="button" onclick="removeWeaknessItem(this)">Remove</button>
          </div>
        </div>
        <button type="button" onclick="addWeaknessItem()">Add More</button>

        <label style="margin-top:8px">Overall Personality Assessment</label>
        <textarea id="overallAssessment">Meera possesses significant untapped potential that is currently being hindered by subconscious negative patterns reflected in her signature. With proper correction techniques, these limitations can be transformed into strengths.</textarea>
      </div>
      <hr style="margin:14px 0" />

      <!-- Section 3 -->
      <div class="form-section">
        <h3 class="small">Section 3 - Corrected Signature</h3>
        <label>Upload up to 3 images (Corrected signature / variations)</label>
        <input id="uploadThree" type="file" accept="image/*" multiple />
        <div id="threePreview" class="muted" style="margin-top:8px">No images</div>

        <label style="margin-top:10px">Corrections made in Signature (Input multiple)</label>
        <div id="sign_corrections_list">
          <div class="sign_correction_item">
            <input type="text" placeholder="Enter Title of correction" class="sign_correction_title"/>
            <textarea placeholder="Enter description of correction" class="sign_correction_desc"></textarea>
            <button type="button" onclick="removeCorrectionItem(this)">Remove</button>
          </div>
        </div>
        <button type="button" onclick="addCorrectionItem()">Add More</button>
      </div>
      <hr style="margin:14px 0" />

      <!-- Section 4 -->
      <div class="form-section">
        <h3 class="small">Section 4 - Benefits / Paragraphs</h3>
        <label>Overall Solution for Meera Khan</label>
        <textarea id="overallBenefit">Upward flowing signature builds positive self-image and increases confidence in all life areas.</textarea>
      </div>
      <hr style="margin:14px 0" />

      <!-- Section 5 -->
      <div class="form-section">
        <h3 class="small">Section 5 - How to Practice new Signature</h3>
        <label>Affirmation</label>
        <textarea id="phase3">I am attracting abundance in my life.</textarea>
        <div style="margin-top:8px" class="muted">Things to remember: You will have a fixed text shown in the report.</div>
      </div>
      <hr style="margin:14px 0" />

      <!-- Section 6 -->
      <div class="form-section">
        <h3 class="small">Section 6 - Legal & Expert Recommendation</h3>
        <div class="muted">Fixed heading: "Understanding Legal Signature Changes" will be shown.</div>
        <label style="margin-top:8px">Expert Recommendation</label>
        <textarea id="expertRec">Given the analysis of your current signature's limitations, we recommend implementing the new signature gradually over 6 months...</textarea>
      </div>
      <hr style="margin:14px 0" />

      <!-- Controls -->
      <div class="controls-row">
        <button id="applyBtn" class="btn btn-primary">Apply to Preview</button>
        <button id="downloadHtml" class="btn btn-primary">Download HTML</button>
        <button id="resetBtn" class="btn btn-ghost">Reset</button>
      </div>
    </div>

    <!-- RIGHT PANEL: Preview (the actual report DOM that will be captured) -->
    <div class="panel preview-area">
      <div id="reportRoot" class="report-wrap">
        <!-- header -->
        <div class="header">
          <h1>Signature Correction Report</h1>
          <p>Professional Analysis & Personalized Solutions</p>
        </div>

        <div class="client-info">
          <h2 id="clientInfoName">Client Information</h2>
          <div class="info-grid">
            <div class="info-item">
              <span class="info-label">Name:</span>
              <span id="r_name">Meera Khan</span>
            </div>
            <div class="info-item">
              <span class="info-label">Date:</span>
              <span id="r_date">August 8, 2025</span>
            </div>
            <div class="info-item">
              <span class="info-label">Report ID:</span>
              <span id="r_id">EXP-2025-001</span>
            </div>
          </div>
        </div>

        <!-- Section 1 -->
        <div class="section">
          <h2 class="section-title">1. MISTAKES IN SIGNATURE</h2>
          <h3>Current Signature Analysis</h3>
          <div id="r_signatureBox" class="signature-box current-signature">
            <img id="r_main_img" class="report-img" src="" alt="Current Signature" style="display:none;" />
            <div id="r_main_placeholder">No signature uploaded</div>
          </div>
          <ul id="r_mistakes_list" class="mistakes-list"></ul>
        </div>

        <!-- Section 2 -->
        <div class="section">
          <h2 class="section-title">2. PERSONALITY ANALYSIS</h2>
          <div class="personality-grid">
            <div class="personality-card">
              <h3>Personality Strengths</h3>
              <ul id="r_strengths_list"></ul>
            </div>
            <div class="personality-card">
              <h3>Personality Weakness</h3>
              <ul id="r_weaknesses_list"></ul>
            </div>
          </div>
          <p><strong>Overall Personality Assessment of <span id="r_overall_name">Meera Khan</span>:</strong> <span id="r_overall">You possess significant untapped potential that is currently being hindered by subconscious negative patterns reflected in her signature. With proper correction techniques, these limitations can be transformed into strengths.</span></p>
        </div>

        <!-- Section 3 -->
        <div class="section">
          <h2 class="section-title">3. CORRECTED SIGNATURE</h2>
          <h3>Recommended New Signature</h3>
          <div id="r_corrected_box" class="signature-box corrected-signature">
            <div id="r_corrected_imgs" style="width:100%; display:flex; gap:10px; justify-content:center; flex-wrap:wrap;"></div>
          </div>
          <h3>Key Improvements Made:</h3>
          <ul id="r_corrections_list" class="mistakes-list"></ul>
        </div>

        <!-- Section 4 -->
        <div class="section">
          <h2 class="section-title">4. BENEFITS OF CORRECTED SIGNATURE IN YOUR LIFE</h2>
          <div class="benefits-grid">
            <div class="benefit-card">
              <div class="benefit-icon">‚ú®</div>
              <h3>Overall Benefit for <span id="r_benefit_name">Meera Khan</span></h3>
              <p id="r_overallbenefit">In here the reader will give me exact solution which the user wanted through signature correction</p>
            </div>
          </div>
        </div>

        <!-- Section 5 -->
     <div class="section">
          <h2 class="section-title">5. HOW TO PRACTICE YOUR NEW SIGNATURE?</h2>

          <div style="background: #f8f9fa; padding: 25px; border-radius: 10px; margin: 20px 0;">
            <h3 style="color: #1a1a1a; margin-bottom: 20px;">What You'll Need:</h3>
            <ul id="r_phase1_list"></ul>
            <div>
              <div style="background: white; padding: 20px; border-radius: 10px; border-left: 5px solid #F4D03F;">
                <ul>
                  <li>Use any smooth-writing pen that feels comfortable in your hand</li>
                  <li>Get a blank notebook (unlined pages work best for free-form practice) </li>

                </ul>
                        
              </div>

              <h3 style="color: #1a1a1a; margin-bottom: 20px; margin-top:20px;">Your Daily Practice Routine:</h3>
              <ul id="r_phase2_list"></ul>
              <div style="background: white; padding: 20px; border-radius: 10px; border-left: 5px solid #F4D03F;">
                <ul>
                  <li>Continue this practice consistently for 3 months </li>
                  <li> As you write each signature, repeat the given affirmation below</li>
                </ul>
                
              </div>

              

              <!-- affirmation box  -->
              <div style="background: white; padding: 20px; border: 2px solid #28a745; margin-top:20px;">
                <h4 id="r_affirmation" style="color: #1a1a1a; margin-bottom: 15px;"><strong> Affirmation:</strong>  I am becoming a better version of me. I attract growth, happiness and abundance. </h4>

                
              </div>
            </div>
          </div>
   <!-- important thing to remember -->
          <h3 style="color: #1a1a1a; margin: 30px 0 20px 0;">**Important things to Remember</h3>
          <div style="background: #f8f9fa; color: black; padding: 25px; border-radius: 15px;">
            <div>
              <div style="background: white; padding: 20px; border-radius: 10px; border-left: 5px solid #F4D03F;" >
                <h4 style="color: #1a1a1a; margin-bottom: 15px; text-decoration: underline;">Self Talk</h4>
                <ul id="r_selftalk"></ul>
                <ul>
                  <li>Monitor the voice in your head - it shapes your reality more than external circumstances </li>
                  <li>  Replace negative internal dialogue with encouraging, supportive thoughts</li>
                  <li>Practice catching yourself when you use limiting language like "I can't" or "I'm not good at"</li>
                </ul>
                <p id = "r_selftalk_impact " style = "margin-top: 10px;"> <strong> How it impacts growth: </strong> Your inner dialogue directly influences your confidence, decision-making, and willingness to take on challenges </p>
                <p  id = "r_selftalk_practice "style = "margin-top: 10px;"> <strong> How to practice: </strong> Set reminders throughout the day to check in with your thoughts, and consciously reframe negative self-talk into constructive feedback </p>
                <!-- <p id = "r_selftalk_link "> <strong>Useful link:</strong> <a href="https://www.explormee.com/">How to practice the correct self talk</a> -->
                </p>
                
              </div>

              <div style="background: white; padding: 20px; border-radius: 10px; border-left: 5px solid #8E44AD; margin-top: 15px;" >
                <h4 style="color: #1a1a1a; margin-bottom: 15px;margin-top:30px; text-decoration: underline;"> Environment </h4>
                <ul id="r_environment"></ul>
                <ul>
                  <li>Surround yourself with people, spaces, and influences that uplift and inspire you </li>
                  <li> Create physical spaces that reflect the person you're becoming, not who you used to be </li>
                  <li>Choose books, music, and media that align with your growth goals </li>
                </ul>
                <p id = "r_environment_impact " style = "margin-top: 10px;"> <strong> How it impacts growth: </strong> Your environment constantly programs your subconscious mind and influences your habits and beliefs </p>
                <p id = "r_environment_practice " style = "margin-top: 10px;"> <strong> How to practice: </strong> Regularly audit your surroundings - declutter spaces that feel stagnant, distance yourself from negative influences, and intentionally add elements that support your vision</p>
                <!-- <p id = "r_environment_link " > <strong>Useful link:</strong> <a href="https://www.explormee.com/">You are an outcome of your environment</a> -->
                </p>
                
              </div>

              <div style="background: white; padding: 20px; border-radius: 10px; border-left: 5px solid #F4D03F; margin-top: 15px;" >
                <h4 style="color: #1a1a1a; margin-bottom: 15px;margin-top:30px; text-decoration: underline;"> Breath  </h4>
                <ul id="r_breath"></ul>
                <ul>
                  <li>Your breathing pattern directly affects your nervous system and emotional state  </li>
                  <li> Conscious breathing helps you stay present and centered during challenging moments  </li>
                  <li>Deep, intentional breathing activates your body's relaxation response  </li>
                </ul>
                <p id="r_breath_impact" style = "margin-top: 10px;"> <strong> How it impacts growth: </strong>Proper breathing reduces stress, improves focus, and helps you respond thoughtfully rather than react impulsively </p>
                <p id="r_breath_practice" style = "margin-top: 10px;"> <strong> How to practice</strong> Take 5 conscious deep breaths when you wake up, before important conversations, and when you feel overwhelmed - make it as automatic as checking your phone</p>
                <!-- <p id="r_breath_link" > <strong>Useful link:</strong> <a href="https://www.explormee.com/">Most effective breathing techniques</a> -->
                </p>
              </div>
            </div>
          </div>
        </div>

        <!-- Section 6 -->
        <div class="section">
          <h2 class="section-title">6. SHOULD YOU CHANGE SIGN LEGALLY?</h2>

          <div style="background: linear-gradient(135deg, #8E44AD 0%, #9B59B6 100%); color: white; padding: 30px; border-radius: 15px; margin: 20px 0;">
            <h3 style="margin-bottom: 20px; text-align: center;">Understanding Legal Signature Changes</h3>
            <p id="r_legal_text" style="font-size: 1.1em; text-align: center; margin-bottom: 20px;">The signature we provide is specifically designed for practice to rewire your subconscious patterns. 
              We create graphologically correct signatures to bring out your best qualities, 
              which may be quite simple for official use. Whether you choose to legally change your signature is entirely up to you. 
              What matters most is practicing daily with the given affirmations. 
              This consistent practice rewires your brain and shifts old patterns.
 </p>
          </div>

          <div style="background: #d1ecf1; padding: 20px; border-radius: 10px; border-left: 5px solid #F4D03F; margin-top: 30px;">
            <h4 style="color: #1a1a1a;">üí° Expert Recommendation for <span id = "r_expert_sugg_name">Meera Khan</span> </h4>
            <p id="r_expert_rec" style="color: #1a1a1a;"> Given the analysis of your current signature's limitations, we recommend implementing the new signature gradually over 6 months. Start with personal documents, then move to professional ones, and finally update official records. This ensures consistency and builds confidence.</p>
          </div>
        </div>

        <div class="footer">
          <p>&copy; 2025 ExplorMee Signature Correction Services. All rights reserved.</p>
          <p>This report is confidential and prepared exclusively for <span id="r_footer_name">Meera Khan</span></p>
        </div>
      </div>
    </div>
  </div>
  <script src="sign_standard.js"></script>
  <script>
document.addEventListener("DOMContentLoaded", () => {
  document.getElementById("downloadHtml").addEventListener("click", async () => {
    // choose whatever section you want to export
    const previewArea = document.querySelector(".preview-area");

    // 1Ô∏è‚É£ Grab all CSS from current page
    const styles = Array.from(document.styleSheets)
      .map(ss => {
        try {
          return Array.from(ss.cssRules)
            .map(rule => rule.cssText)
            .join('');
        } catch {
          return '';
        }
      })
      .join('');

    // 2Ô∏è‚É£ Clone preview and inline/compress images as base64 JPEG
    const clone = previewArea.cloneNode(true);
    const images = clone.querySelectorAll("img");
    for (const img of images) {
      try {
        const dataUrl = await toCompressedDataURL(img.src, 0.7); // 70% quality
        img.src = dataUrl;
      } catch (e) {
        console.warn("Could not inline image", img.src, e);
      }
    }

    // 3Ô∏è‚É£ Build full HTML with styles
    const htmlContent = `
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Signature Analysis Snapshot</title>
<style>
${styles}
/* style for an optional print button */
#printBtn {
  display:inline-block;
  padding:10px 15px;
  margin:10px 0;
  background:teal;
  color:#fff;
  border:none;
  cursor:pointer;
  font-size:16px;
}
</style>
</head>
<body>
${clone.outerHTML}
</body>
</html>`;

    // 4Ô∏è‚É£ Download
    const blob = new Blob([htmlContent], { type: "text/html" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    // use a safe filename
    const nameEl = document.getElementById("r_name") || {};
    const filename = (nameEl.textContent || "signature_analysis")
                       .trim().replace(/\s+/g, "_").toLowerCase();
    a.href = url;
    a.download = `${filename}.html`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  });

  // helper: convert image URL to compressed JPEG base64 string
  async function toCompressedDataURL(url, quality = 0.7) {
    return new Promise((resolve, reject) => {
      const img = new Image();
      img.crossOrigin = "anonymous";
      img.onload = function () {
        const canvas = document.createElement("canvas");
        canvas.width = img.width;
        canvas.height = img.height;
        const ctx = canvas.getContext("2d");
        ctx.drawImage(img, 0, 0);
        resolve(canvas.toDataURL("image/jpeg", quality));
      };
      img.onerror = reject;
      img.src = url;
    });
  }
});
</script>


</body>
</html>
